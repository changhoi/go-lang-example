# 프로그램 구조

## 이름

문자나 밑줄로 시작하고, 그 뒤에 부가적인 문자, 숫자, 밑줄을 사용할 수 있다. 대소문자도 구별 가능하다.

문법상으로 지정된 예약어들은 변수 명으로 사용할 수 없지만, 이미 정의된 상수, 타입, 함수의 이름은 변수 명으로 사용할 수 있고, 이름을 재정의 할 수도 있다.

변수명 선언이 함수 안에서 이루어진 경우에는 함수 안에서만 사용할 수 있지만, 함수 밖에서 사용된 경우에는 같은 패키지의 모든 파일에서 볼 수 있다. 이름 첫 글자의 대소문자 구분으로 다른 파일에서의 가시성을 결정할 수 있다. 만약 대문자로 작성하면 패키지 밖에서도 보거나 사용할 수 있다. (패키지명 자체는 항상 소문자)

Go 프로그래밍에서는 짧은 변수명을 선호하기 때문에 관용적인 약어를 주로 사용하게 된다.

## 선언

선언으로서 프로그램 개체에 이름을 붙인다. 선언할 때는 `var`, `const`, `type`, `func`를 가지고 선언을 하게 된다.

Go 프로그램은 `*.go`로 끝나는 하나 이상의 파일에 저장되고, 각 파일은 파일이 어느 패키지에 속하는지 알리는 `package` 선언으로 시작하게 되어있다.

## 변수

`var`을 사용해서 특정 타입의 변수를 만들 수 있다.

```go
var 이름 타입 = 표현식 // 타입이나 표현식 둘 중 하나는 생략할 수 있다.
```

타입이 없으면 표현식으로 그 타입을 결정하고, 표현식이 없으면 타입으로 타입을 결정한 다음 해당 타입의 `zero value`로 값을 초기화 한다.
`zero value`는 숫자는 `0`, 불리언은 `false`, 문자열은 `""`, 인터페이스와 참조 타입은 `nil`이 된다.

함수 안에서는 짧게 변수를 선언할 수 있다.

```go
변수 := 표현식
```

짧게 변수를 선언할 때는 항상 선언이 되는 것은 아니고, 여러 변수를 짧은 변수로 선언 할 때 그 중 일부가 이미 같은 어휘 블록에 선언 되어 있는 경우, 값을 할당하는 식으로 동작한다.

```go
in, err := os.Open(name)

...

out, err := os.Create(outFile) // 동작함
```

다만 아래처럼 모두 이미 선언된 변수인 경우에는 안된다.

```go
f, err := os.Open(inFile)

...

f, err := os.Create(outFile) // 컴파일 에러, 새 변수 없음
```

## 포인터

모든 변수에는 주소값이 있다. 어떤 변수가 `var x int`라고 선언 된 경우에 `&x`로 주소를 알아낼 수 있다. `&x`의 타입은 `*int`이 되고 '정수 포인터'라고 한다. 변수에 주소값을 저장한 경우에 그 주소값을 통해 값을 확인할 때 `*변수` 형태로 확인할 수 있다.

```go
x := 1
p := &x
fmt.Println(*p) // 1
*p = 2 // x = 2와 같은 의미
fmt.Println(x)
```

## new 함수

변수를 생성하는 또 다른 방법이다. `new(T)` 표현식은 `T` 타입의 이름 없는 변수를 만들고 T의 제로 값으로 초기화한 후 `*T` 타입의 값인 변수의 주소를 반환한다.

```go
p := new(int) // 이름 없는 int 변수를 가리키는 *int 타입의 p
fmt.Println(*p) // "0"
*p = 2
fmt.Println(*p) // "2"
```

## 변수의 수명

변수의 수명은 프로그램이 실행될 때 변수가 존재하는 시간의 길이이다. 패키지 수준의 변수의 수명은 프로그램 전체 실행 기간과 같다. 반면, 지역 변수의 수명은 동적이다. 선언문이 실행될 때마다 새 인스턴스가 생성되고, 이 변수는 더 이상 접근할 수 없어서 해당 변수의 저장 공간이 재활용 될 때까지 살아있다.

## 타입 선언

`type` 선언은 기존 타입과 같은 내부 타입을 갖는 새 명명된 타입을 정의한다. 명명된 타입은 별개의 호환되지 않을 수도 있는 내부 타입에 이름을 붙여 의도치 않게 섞이지 않도록 한다.

```go
type 이름 내부타입
```

타입 선언은 보통 패키지 전체에서 볼 수 있는 패키지 수준에서 가장 많이 나타나고, 이름이 대문자로 시작하면 마찬가지로 다른 패키지에서도 볼 수 있다.

모든 타입 `T`에는 값 `x`를 `T`로 변환하는 변환 명령 `T(x)`가 있다. 한 타입에서 다른 타입으로의 변환은 둘 다 동일한 내부 타입을 갖고 있거나 동일한 내부 타입의 변수를 가리키는 이름 없는 포인터일 때만 허용된다. 이런 변환은 타입만 변경할 뿐, 값을 변경할 수는 없다.

## 패키지와 파일
